import{a as Q,b as X,c as Z}from"./chunk-5K23OSKE.js";import"./chunk-X5YLR3NI.js";import{a as K}from"./chunk-RAM765LW.js";import{$a as S,$b as W,B as p,Bc as G,C as f,Ea as a,Ec as q,Ia as _,Ib as P,Ic as J,Ja as v,Jb as F,Ka as M,Kb as I,Lb as A,Mb as T,Mc as Y,Ob as B,T as d,Vb as V,X as h,Yb as D,Z as y,Za as w,Zb as z,_ as k,_b as N,ac as j,bc as L,cc as U,da as u,fa as m,gc as H,jb as O,oa as i,pa as e,qa as C,ta as b,u as E,va as g,wa as s,yc as R}from"./chunk-KOLL3EMX.js";import{i as x}from"./chunk-ODN5LVDJ.js";var $=(()=>{class n{static \u0275fac=function(c){return new(c||n)};static \u0275mod=k({type:n});static \u0275inj=E({imports:[P,P]})}return n})();function it(n,r){n&1&&(i(0,"div",6),C(1,"mat-spinner"),i(2,"p"),a(3,"Cargando perfil..."),e()())}function nt(n,r){if(n&1){let t=b();i(0,"button",19),g("click",function(){p(t);let o=s(2);return f(o.startEditing())}),i(1,"mat-icon"),a(2,"edit"),e()()}}function at(n,r){n&1&&(i(0,"mat-icon"),a(1,"save"),e())}function ot(n,r){n&1&&C(0,"mat-spinner",24)}function rt(n,r){if(n&1){let t=b();i(0,"div",20)(1,"button",21),g("click",function(){p(t);let o=s(2);return f(o.cancelEditing())}),i(2,"mat-icon"),a(3,"close"),e()(),i(4,"button",22),g("click",function(){p(t);let o=s(2);return f(o.saveProfile())}),u(5,at,2,0,"mat-icon",15)(6,ot,1,0,"mat-spinner",23),e()()}if(n&2){let t=s(2);d(4),m("disabled",t.saving),d(),m("ngIf",!t.saving),d(),m("ngIf",t.saving)}}function dt(n,r){n&1&&(i(0,"mat-hint"),a(1,"No especificado"),e())}function mt(n,r){n&1&&(i(0,"mat-hint"),a(1,"No especificado"),e())}function ct(n,r){n&1&&(i(0,"mat-hint"),a(1,"No especificada"),e())}function lt(n,r){n&1&&(i(0,"mat-hint"),a(1,"No especificada"),e())}function st(n,r){if(n&1){let t=b();i(0,"div",7)(1,"mat-card",8)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),a(5,"person"),e(),a(6," Informaci\xF3n Personal "),e(),i(7,"div",9),u(8,nt,3,0,"button",10)(9,rt,7,3,"div",11),e()(),i(10,"mat-card-content")(11,"div",12)(12,"mat-form-field",13)(13,"mat-label"),a(14,"Nombre de usuario"),e(),i(15,"input",14),M("ngModelChange",function(o){p(t);let l=s();return v(l.editForm.username,o)||(l.editForm.username=o),f(o)}),e(),u(16,dt,2,0,"mat-hint",15),e(),i(17,"mat-form-field",13)(18,"mat-label"),a(19,"Nombre completo"),e(),i(20,"input",16),M("ngModelChange",function(o){p(t);let l=s();return v(l.editForm.full_name,o)||(l.editForm.full_name=o),f(o)}),e(),u(21,mt,2,0,"mat-hint",15),e(),i(22,"mat-form-field",13)(23,"mat-label"),a(24,"Fecha de nacimiento"),e(),i(25,"input",17),M("ngModelChange",function(o){p(t);let l=s();return v(l.editForm.birthdate,o)||(l.editForm.birthdate=o),f(o)}),e(),u(26,ct,2,0,"mat-hint",15),e(),i(27,"mat-form-field",13)(28,"mat-label"),a(29,"Biograf\xEDa"),e(),i(30,"textarea",18),M("ngModelChange",function(o){p(t);let l=s();return v(l.editForm.bio,o)||(l.editForm.bio=o),f(o)}),e(),u(31,lt,2,0,"mat-hint",15),e()()()(),i(32,"mat-card",8)(33,"mat-card-header")(34,"mat-card-title")(35,"mat-icon"),a(36,"security"),e(),a(37," Seguridad "),e()(),i(38,"mat-card-content")(39,"p"),a(40,"Gestiona tu contrase\xF1a y configuraci\xF3n de seguridad"),e()()(),i(41,"mat-card",8)(42,"mat-card-header")(43,"mat-card-title")(44,"mat-icon"),a(45,"settings"),e(),a(46," Preferencias "),e()(),i(47,"mat-card-content")(48,"p"),a(49,"Configura tus preferencias de la aplicaci\xF3n"),e()()()()}if(n&2){let t=s();d(8),m("ngIf",!t.isEditing),d(),m("ngIf",t.isEditing),d(6),_("ngModel",t.editForm.username),m("readonly",!t.isEditing),d(),m("ngIf",!t.isEditing&&!(t.profile!=null&&t.profile.username)),d(4),_("ngModel",t.editForm.full_name),m("readonly",!t.isEditing),d(),m("ngIf",!t.isEditing&&!(t.profile!=null&&t.profile.full_name)),d(4),_("ngModel",t.editForm.birthdate),m("readonly",!t.isEditing),d(),m("ngIf",!t.isEditing&&!(t.profile!=null&&t.profile.birthdate)),d(4),_("ngModel",t.editForm.bio),m("readonly",!t.isEditing),d(),m("ngIf",!t.isEditing&&!(t.profile!=null&&t.profile.bio))}}var tt=class n{constructor(r,t,c){this.supabaseService=r;this.snackBar=t;this.router=c}profile=null;loading=!1;isEditing=!1;saving=!1;editForm={username:"",full_name:"",bio:"",birthdate:""};ngOnInit(){this.loadProfile()}goBack(){this.router.navigate(["/home"])}loadProfile(){return x(this,null,function*(){this.loading=!0;try{let{data:r,error:t}=yield this.supabaseService.getUserProfile();t?this.snackBar.open("Error al cargar el perfil","Cerrar",{duration:3e3}):(this.profile=r,this.initializeEditForm())}catch{this.snackBar.open("Error al cargar el perfil","Cerrar",{duration:3e3})}finally{this.loading=!1}})}initializeEditForm(){this.profile&&(this.editForm={username:this.profile.username||"",full_name:this.profile.full_name||"",bio:this.profile.bio||"",birthdate:this.profile.birthdate||""})}startEditing(){this.isEditing=!0,this.initializeEditForm()}cancelEditing(){this.isEditing=!1,this.initializeEditForm()}saveProfile(){return x(this,null,function*(){this.saving=!0;try{let{data:r,error:t}=yield this.supabaseService.updateUserProfile({username:this.editForm.username,full_name:this.editForm.full_name,bio:this.editForm.bio,birthdate:this.editForm.birthdate});t?this.snackBar.open("Error al actualizar el perfil","Cerrar",{duration:3e3}):(this.profile=r,this.isEditing=!1,this.snackBar.open("Perfil actualizado exitosamente","Cerrar",{duration:3e3}))}catch{this.snackBar.open("Error al actualizar el perfil","Cerrar",{duration:3e3})}finally{this.saving=!1}})}formatDate(r){return r?new Date(r).toLocaleDateString("es-ES"):"No especificada"}static \u0275fac=function(t){return new(t||n)(h(Z),h(Y),h(O))};static \u0275cmp=y({type:n,selectors:[["app-my-account"]],decls:12,vars:2,consts:[[1,"my-account-container"],[1,"my-account-content"],["mat-icon-button","","aria-label","Volver",1,"back-button",3,"click"],[1,"page-header"],["class","loading-container",4,"ngIf"],["class","account-sections",4,"ngIf"],[1,"loading-container"],[1,"account-sections"],[1,"account-section"],[1,"card-actions"],["mat-icon-button","","class","edit-btn",3,"click",4,"ngIf"],["class","edit-actions",4,"ngIf"],[1,"profile-form"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Tu nombre de usuario",3,"ngModelChange","ngModel","readonly"],[4,"ngIf"],["matInput","","placeholder","Tu nombre completo",3,"ngModelChange","ngModel","readonly"],["matInput","","type","date",3,"ngModelChange","ngModel","readonly"],["matInput","","placeholder","Cu\xE9ntanos sobre ti...","rows","3",3,"ngModelChange","ngModel","readonly"],["mat-icon-button","",1,"edit-btn",3,"click"],[1,"edit-actions"],["mat-icon-button","",1,"cancel-btn",3,"click"],["mat-icon-button","",1,"save-btn",3,"click","disabled"],["diameter","20",4,"ngIf"],["diameter","20"]],template:function(t,c){t&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return c.goBack()}),i(3,"mat-icon"),a(4,"arrow_back"),e()(),i(5,"header",3)(6,"h1"),a(7,"Mi Cuenta"),e(),i(8,"p"),a(9,"Gestiona tu perfil y configuraci\xF3n"),e()(),u(10,it,4,0,"div",4)(11,st,50,14,"div",5),e()()),t&2&&(d(10),m("ngIf",c.loading),d(),m("ngIf",!c.loading))},dependencies:[S,w,J,R,G,q,B,F,A,T,I,D,V,N,z,K,H,L,U,X,Q,$,j,W],styles:[".my-account-container[_ngcontent-%COMP%]{min-height:100vh;background:var(--background-color);padding:20px}.my-account-content[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.back-button[_ngcontent-%COMP%]{color:#fff;background:#00000080;position:fixed;top:20px;left:20px;z-index:10}.page-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px;margin-top:50px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--text-color);margin:0 0 8px;font-size:2rem;font-weight:500}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--detail-meta);margin:0;font-size:1rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:var(--detail-meta)}.account-sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.account-section[_ngcontent-%COMP%]{background:var(--card-bg);border:1px solid var(--card-border);border-radius:12px;overflow:hidden}.account-section[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:var(--card-border);padding:16px 20px;display:flex;justify-content:space-between;align-items:center}.account-section[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--text-color);font-size:1.1rem;font-weight:500;margin:0}.account-section[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color)}.account-section[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:20px}.account-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--detail-meta);margin:0;line-height:1.5}.card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.edit-btn[_ngcontent-%COMP%]{color:var(--primary-color)!important}.edit-btn[_ngcontent-%COMP%]:hover{background:rgba(var(--primary-color-rgb),.1)!important}.edit-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.cancel-btn[_ngcontent-%COMP%]{color:#f44336!important}.cancel-btn[_ngcontent-%COMP%]:hover{background:#f443361a!important}.save-btn[_ngcontent-%COMP%]{color:#4caf50!important}.save-btn[_ngcontent-%COMP%]:hover{background:#4caf501a!important}.save-btn[_ngcontent-%COMP%]:disabled{opacity:.6}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}  .mat-mdc-form-field.mat-form-field-disabled .mat-mdc-form-field-infix{background:var(--card-border);border-radius:4px}  .mat-mdc-form-field.mat-form-field-disabled .mat-mdc-text-field-wrapper{background:transparent}  .dark-mode .mat-mdc-form-field-infill,   .dark-mode .mat-mdc-form-field,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-focus-overlay,   .dark-mode .mat-mdc-form-field .mat-mdc-text-field-wrapper,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-flex,   .dark-mode .mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay,   .dark-mode .mat-mdc-form-field.mat-focused .mat-mdc-text-field-wrapper{background:transparent!important;background-color:transparent!important}  .dark-mode .mat-mdc-form-field .mat-mdc-form-field-label,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-label.mat-mdc-form-field-label-always-float,   .dark-mode .mat-mdc-form-field input.mat-mdc-input-element,   .dark-mode .mat-mdc-form-field textarea.mat-mdc-input-element,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-label-wrapper,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-label-wrapper .mat-mdc-form-field-label,   .dark-mode mat-label,   .dark-mode .mat-mdc-form-field mat-label,   .dark-mode .mat-mdc-form-field .mat-mdc-form-field-label-wrapper mat-label{color:#ffffffde!important}  .dark-mode .mat-mdc-form-field .mat-mdc-form-field-hint{color:#fff9!important}  .dark-mode .mat-mdc-form-field .mat-mdc-input-element::placeholder{color:#fff9!important}  .dark-mode .mat-mdc-form-field.mat-form-field-disabled .mat-mdc-input-element,   .dark-mode .mat-mdc-form-field.mat-form-field-disabled .mat-mdc-form-field-label{color:#ffffff61!important}@media (max-width: 768px){.my-account-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.account-section[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:12px 16px;flex-direction:row;justify-content:space-between;align-items:center;gap:8px}.card-actions[_ngcontent-%COMP%]{flex-shrink:0}.account-section[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}.profile-form[_ngcontent-%COMP%]{gap:12px}}"]})};export{tt as MyAccountComponent};
